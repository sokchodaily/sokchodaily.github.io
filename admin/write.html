<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì†ì´ˆì¼ë³´ ë¸”ë¡œê·¸ ì—ë””í„°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans KR', sans-serif;
            background-color: #f5f6f7;
            color: #333;
        }

        .editor-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        /* í—¤ë” */
        .editor-header {
            background: #03c75a;
            color: white;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid #02b350;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: bold;
            font-size: 16px;
        }

        .logo::before {
            content: "ì†";
            background: white;
            color: #03c75a;
            width: 32px;
            height: 24px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
        }

        .header-actions {
            display: flex;
            gap: 12px;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }

        .btn-primary {
            background: #ff6b35;
            color: white;
        }

        .btn-primary:hover {
            background: #e55a2b;
        }

        .btn-secondary {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.3);
        }

        /* íˆ´ë°” */
        .toolbar {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            background: #fafafa;
            border-bottom: 1px solid #e5e5e5;
            gap: 4px;
            flex-wrap: wrap;
        }

        .toolbar-group {
            display: flex;
            align-items: center;
            gap: 4px;
            padding-right: 12px;
            border-right: 1px solid #ddd;
            margin-right: 12px;
        }

        .toolbar-group:last-child {
            border-right: none;
            margin-right: 0;
        }

        .tool-btn {
            width: 32px;
            height: 32px;
            border: none;
            background: transparent;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: #666;
            transition: all 0.2s;
        }

        .tool-btn:hover {
            background: #e9e9e9;
            color: #333;
        }

        .tool-btn.active {
            background: #03c75a;
            color: white;
        }

        .font-select, .size-select {
            padding: 6px 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: white;
            font-size: 14px;
            min-width: 80px;
        }

        .color-picker {
            width: 32px;
            height: 32px;
            border: 2px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            background: #000;
        }

        /* ì—ë””í„° ì˜ì—­ */
        .editor-content {
            display: flex;
            height: calc(100vh - 120px);
        }

        .sidebar {
            width: 240px;
            background: #f8f9fa;
            border-right: 1px solid #e5e5e5;
            padding: 20px;
            overflow-y: auto;
        }

        .sidebar-section {
            margin-bottom: 24px;
        }

        .sidebar-title {
            font-size: 14px;
            font-weight: bold;
            color: #333;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .insert-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 8px;
            border: 1px solid #e5e5e5;
            background: white;
        }

        .insert-item:hover {
            background: #f0f8ff;
            border-color: #03c75a;
        }

        .insert-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f5f5f5;
            border-radius: 4px;
            font-size: 12px;
        }

        .main-editor {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .title-input {
            border: none;
            padding: 24px 40px;
            font-size: 24px;
            font-weight: bold;
            background: white;
            border-bottom: 1px solid #e5e5e5;
            outline: none;
        }

        .title-input::placeholder {
            color: #999;
        }

        .content-editor {
            flex: 1;
            padding: 40px;
            background: white;
            overflow-y: auto;
        }

        .editable {
            min-height: 500px;
            line-height: 1.8;
            font-size: 16px;
            outline: none;
            border: none;
        }

        .editable:empty::before {
            content: "ì†ì´ˆì˜ ì†Œì‹ì„ ì „í•´ë³´ì„¸ìš”!";
            color: #999;
        }

        /* ëª¨ë‹¬ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 8px;
            padding: 24px;
            min-width: 400px;
            max-width: 600px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid #e5e5e5;
        }

        .modal-title {
            font-size: 18px;
            font-weight: bold;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
        }

        .close-btn:hover {
            background: #f5f5f5;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .form-input:focus {
            outline: none;
            border-color: #03c75a;
        }

        .image-upload-area {
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 40px;
            text-align: center;
            background: #fafafa;
            cursor: pointer;
            transition: all 0.2s;
        }

        .image-upload-area:hover {
            border-color: #03c75a;
            background: #f0f8ff;
        }

        .upload-icon {
            font-size: 48px;
            color: #ccc;
            margin-bottom: 16px;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .editor-content {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
                border-right: none;
                border-bottom: 1px solid #e5e5e5;
            }
            
            .toolbar {
                overflow-x: auto;
                flex-wrap: nowrap;
            }
            
            .title-input {
                padding: 20px;
                font-size: 20px;
            }
            
            .content-editor {
                padding: 20px;
            }
        }

        /* ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ */
        .inserted-image {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 16px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        /* í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .editor-table {
            width: 100%;
            border-collapse: collapse;
            margin: 16px 0;
        }

        .editor-table th,
        .editor-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        .editor-table th {
            background: #f8f9fa;
            font-weight: bold;
        }

        /* ë§í¬ ìŠ¤íƒ€ì¼ */
        .editable a {
            color: #03c75a;
            text-decoration: none;
        }

        .editable a:hover {
            text-decoration: underline;
        }

        /* ë°œí–‰ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .publish-form {
            max-height: 500px;
            overflow-y: auto;
        }

        .radio-group {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 8px;
        }

        .radio-label {
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            font-size: 14px;
        }

        .radio-label input[type="radio"] {
            margin: 0;
        }

        .checkbox-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 8px;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            font-size: 14px;
        }

        .checkbox-label input[type="checkbox"] {
            margin: 0;
        }

        .help-text {
            font-size: 12px;
            color: #666;
            margin-top: 8px;
            margin-bottom: 0;
        }

        @media (max-width: 768px) {
            .radio-group {
                flex-direction: column;
                gap: 12px;
            }
            
            .checkbox-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="editor-container">
        <!-- í—¤ë” -->
        <div class="editor-header">
            <div class="logo">ì†ì´ˆì¼ë³´</div>
            <div class="header-actions">
                <button class="btn btn-secondary">ì„ì‹œì €ì¥</button>
                <button class="btn btn-primary" onclick="publishPost()">ë°œí–‰</button>
            </div>
        </div>

        <!-- íˆ´ë°” -->
        <div class="toolbar">
            <div class="toolbar-group">
                <select class="font-select" onchange="changeFont(this.value)">
                    <option value="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif">ê¸°ë³¸</option>
                    <option value="font-family: 'Noto Sans KR', sans-serif">ë‚˜ëˆ”ê³ ë”•</option>
                    <option value="font-family: 'Noto Serif KR', serif">ë‚˜ëˆ”ëª…ì¡°</option>
                    <option value="font-family: 'Do Hyeon', sans-serif">ë„í˜„ì²´</option>
                </select>
                <select class="size-select" onchange="changeFontSize(this.value)">
                    <option value="12px">12px</option>
                    <option value="14px">14px</option>
                    <option value="16px" selected>16px</option>
                    <option value="18px">18px</option>
                    <option value="20px">20px</option>
                    <option value="24px">24px</option>
                    <option value="32px">32px</option>
                </select>
            </div>

            <div class="toolbar-group">
                <button class="tool-btn" onclick="execCommand('bold')" title="êµµê²Œ">
                    <strong>B</strong>
                </button>
                <button class="tool-btn" onclick="execCommand('italic')" title="ê¸°ìš¸ì„">
                    <em>I</em>
                </button>
                <button class="tool-btn" onclick="execCommand('underline')" title="ë°‘ì¤„">
                    <u>U</u>
                </button>
                <button class="tool-btn" onclick="execCommand('strikeThrough')" title="ì·¨ì†Œì„ ">
                    <s>S</s>
                </button>
            </div>

            <div class="toolbar-group">
                <input type="color" class="color-picker" onchange="changeTextColor(this.value)" title="ê¸€ììƒ‰">
                <button class="tool-btn" onclick="execCommand('hiliteColor', '#ffff00')" title="í˜•ê´‘íœ">
                    ğŸ–ï¸
                </button>
            </div>

            <div class="toolbar-group">
                <button class="tool-btn" onclick="execCommand('justifyLeft')" title="ì™¼ìª½ ì •ë ¬">
                    â¬…ï¸
                </button>
                <button class="tool-btn" onclick="execCommand('justifyCenter')" title="ê°€ìš´ë° ì •ë ¬">
                    â†”ï¸
                </button>
                <button class="tool-btn" onclick="execCommand('justifyRight')" title="ì˜¤ë¥¸ìª½ ì •ë ¬">
                    â¡ï¸
                </button>
            </div>

            <div class="toolbar-group">
                <button class="tool-btn" onclick="execCommand('insertUnorderedList')" title="ê¸€ë¨¸ë¦¬ ê¸°í˜¸">
                    â€¢
                </button>
                <button class="tool-btn" onclick="execCommand('insertOrderedList')" title="ë²ˆí˜¸ ë§¤ê¸°ê¸°">
                    1.
                </button>
                <button class="tool-btn" onclick="execCommand('outdent')" title="ë‚´ì–´ì“°ê¸°">
                    â¬…
                </button>
                <button class="tool-btn" onclick="execCommand('indent')" title="ë“¤ì—¬ì“°ê¸°">
                    â¡
                </button>
            </div>

            <div class="toolbar-group">
                <button class="tool-btn" onclick="execCommand('undo')" title="ì‹¤í–‰ ì·¨ì†Œ">
                    â†¶
                </button>
                <button class="tool-btn" onclick="execCommand('redo')" title="ë‹¤ì‹œ ì‹¤í–‰">
                    â†·
                </button>
            </div>
        </div>

        <!-- ì—ë””í„° ì½˜í…ì¸  -->
        <div class="editor-content">
            <!-- ì‚¬ì´ë“œë°” -->
            <div class="sidebar">
                <div class="sidebar-section">
                    <div class="sidebar-title">ğŸ“· ì‚¬ì§„</div>
                    <div class="insert-item" onclick="openImageModal()">
                        <div class="insert-icon">ğŸ–¼ï¸</div>
                        <div>ì‚¬ì§„ ì—…ë¡œë“œ</div>
                    </div>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-title">ğŸ˜Š ìŠ¤í‹°ì»¤</div>
                    <div class="insert-item" onclick="insertEmoji('ğŸ˜Š')">
                        <div class="insert-icon">ğŸ˜Š</div>
                        <div>ì´ëª¨í‹°ì½˜</div>
                    </div>
                    <div class="insert-item" onclick="insertEmoji('â¤ï¸')">
                        <div class="insert-icon">â¤ï¸</div>
                        <div>í•˜íŠ¸</div>
                    </div>
                    <div class="insert-item" onclick="insertEmoji('ğŸ‘')">
                        <div class="insert-icon">ğŸ‘</div>
                        <div>ì¢‹ì•„ìš”</div>
                    </div>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-title">ğŸ“‹ êµ¬ì¡°</div>
                    <div class="insert-item" onclick="insertDivider()">
                        <div class="insert-icon">â€”</div>
                        <div>êµ¬ë¶„ì„ </div>
                    </div>
                    <div class="insert-item" onclick="insertTable()">
                        <div class="insert-icon">âŠ</div>
                        <div>í‘œ</div>
                    </div>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-title">ğŸ”— ë§í¬</div>
                    <div class="insert-item" onclick="openLinkModal()">
                        <div class="insert-icon">ğŸ”—</div>
                        <div>ë§í¬ ì¶”ê°€</div>
                    </div>
                </div>
            </div>

            <!-- ë©”ì¸ ì—ë””í„° -->
            <div class="main-editor">
                <input type="text" class="title-input" placeholder="ì œëª©" id="postTitle">
                <div class="content-editor">
                    <div class="editable" contenteditable="true" id="postContent"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- ì´ë¯¸ì§€ ì—…ë¡œë“œ ëª¨ë‹¬ -->
    <div id="imageModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">ì‚¬ì§„ ì—…ë¡œë“œ</div>
                <button class="close-btn" onclick="closeModal('imageModal')">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">ì´ë¯¸ì§€ íŒŒì¼ ì„ íƒ</label>
                <div class="image-upload-area" onclick="document.getElementById('imageInput').click()">
                    <div class="upload-icon">ğŸ“</div>
                    <div>í´ë¦­í•˜ì—¬ ì´ë¯¸ì§€ë¥¼ ì„ íƒí•˜ê±°ë‚˜ ì—¬ê¸°ì— ë“œë˜ê·¸í•˜ì„¸ìš”</div>
                    <input type="file" id="imageInput" accept="image/*" style="display: none;" onchange="handleImageUpload(event)">
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">ë˜ëŠ” ì´ë¯¸ì§€ URL ì…ë ¥</label>
                <input type="text" class="form-input" id="imageUrl" placeholder="https://example.com/image.jpg">
            </div>
            <div style="text-align: right; margin-top: 20px;">
                <button class="btn btn-secondary" onclick="closeModal('imageModal')">ì·¨ì†Œ</button>
                <button class="btn btn-primary" onclick="insertImage()">ì‚½ì…</button>
            </div>
        </div>
    </div>

    <!-- ë§í¬ ëª¨ë‹¬ -->
    <div id="linkModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">ë§í¬ ì¶”ê°€</div>
                <button class="close-btn" onclick="closeModal('linkModal')">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">ë§í¬ í…ìŠ¤íŠ¸</label>
                <input type="text" class="form-input" id="linkText" placeholder="ë§í¬ í…ìŠ¤íŠ¸">
            </div>
            <div class="form-group">
                <label class="form-label">ë§í¬ URL</label>
                <input type="text" class="form-input" id="linkUrl" placeholder="https://example.com">
            </div>
            <div style="text-align: right; margin-top: 20px;">
                <button class="btn btn-secondary" onclick="closeModal('linkModal')">ì·¨ì†Œ</button>
                <button class="btn btn-primary" onclick="insertLink()">ì‚½ì…</button>
            </div>
        </div>
    </div>

    <!-- ë°œí–‰ ì„¤ì • ëª¨ë‹¬ -->
    <div id="publishModal" class="modal">
        <div class="modal-content" style="min-width: 500px; max-width: 700px;">
            <div class="modal-header">
                <div class="modal-title">ë°œí–‰ ì„¤ì •</div>
                <button class="close-btn" onclick="closeModal('publishModal')">&times;</button>
            </div>
            
            <div class="publish-form">
                <div class="form-group">
                    <label class="form-label">ì¹´í…Œê³ ë¦¬</label>
                    <select class="form-input" id="publishCategory">
                        <option value="ì†ì´ˆì‹œì •">ì†ì´ˆì‹œì •</option>
                        <option value="ì†ì´ˆì˜íšŒ">ì†ì´ˆì˜íšŒ</option>
                        <option value="ì†ì´ˆê²½ì°°ì„œ">ì†ì´ˆê²½ì°°ì„œ</option>
                        <option value="ì†ì´ˆí•´ì–‘ê²½ì°°ì„œ">ì†ì´ˆí•´ì–‘ê²½ì°°ì„œ</option>
                        <option value="ì†ì´ˆì†Œë°©ì„œ">ì†ì´ˆì†Œë°©ì„œ</option>
                        <option value="ì‚¬íšŒ">ì‚¬íšŒ</option>
                        <option value="ê²½ì œ">ê²½ì œ</option>
                        <option value="ë¬¸í™”">ë¬¸í™”</option>
                        <option value="ìŠ¤í¬ì¸ ">ìŠ¤í¬ì¸ </option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">ì£¼ì œ</label>
                    <input type="text" class="form-input" id="publishSubject" placeholder="ì£¼ì œë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                </div>

                <div class="form-group">
                    <label class="form-label">ê³µê°œ ì„¤ì •</label>
                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="visibility" value="ì „ì²´ê³µê°œ" checked>
                            <span>ì „ì²´ê³µê°œ</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="visibility" value="ì´ì›ƒê³µê°œ">
                            <span>ì´ì›ƒê³µê°œ</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="visibility" value="ì„œë¡œì´ì›ƒê³µê°œ">
                            <span>ì„œë¡œì´ì›ƒê³µê°œ</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="visibility" value="ë¹„ê³µê°œ">
                            <span>ë¹„ê³µê°œ</span>
                        </label>
                    </div>
                    <p class="help-text">ëª¨ë“  ì‚¬ëŒì´ ì´ ê¸€ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                </div>

                <div class="form-group">
                    <label class="form-label">ë°œí–‰ ì„¤ì •</label>
                    <div class="checkbox-grid">
                        <label class="checkbox-label">
                            <input type="checkbox" id="allowComments" checked>
                            <span>ëŒ“ê¸€í—ˆìš©</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="allowGuestComments">
                            <span>ê³µê°í—ˆìš©</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="allowScraps" checked>
                            <span>ê²€ìƒ‰í—ˆìš©</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="blogCafePush" checked>
                            <span>ë¸”ë¡œê·¸/ì¹´í˜ ê³µìœ </span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="allowExternalShare" checked>
                            <span>ì™¸ë¶€ ê³µìœ  í—ˆìš©</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="ccl">
                            <span>CCLí‘œì‹œ</span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="saveAsDefault">
                        <span>ì´ ì„¤ì •ì„ ê¸°ë³¸ê°’ìœ¼ë¡œ ìœ ì§€</span>
                    </label>
                </div>

                <div class="form-group">
                    <label class="form-label">íƒœê·¸ í¸ì§‘</label>
                    <textarea class="form-input" id="publishTags" placeholder="#íƒœê·¸ ì…ë ¥ (ìµœëŒ€ 30ê°œ)" rows="3"></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">ë°œí–‰ ì‹œê°„</label>
                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="publishTime" value="í˜„ì¬" checked>
                            <span>í˜„ì¬</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="publishTime" value="ì˜ˆì•½">
                            <span>ì˜ˆì•½</span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="notifySubscribers">
                        <span>ê³µì§€ì‚¬í•­ìœ¼ë¡œ ë“±ë¡</span>
                    </label>
                </div>
            </div>

            <div style="text-align: right; margin-top: 24px; padding-top: 20px; border-top: 1px solid #e5e5e5;">
                <button class="btn btn-secondary" onclick="closeModal('publishModal')" style="margin-right: 12px;">ì·¨ì†Œ</button>
                <button class="btn btn-primary" onclick="finalPublish()">âœ“ ë°œí–‰</button>
            </div>
        </div>
    </div>

    <script>
        // ì—ë””í„° ì°¸ì¡°
        const editor = document.getElementById('postContent');

        // ëª…ë ¹ ì‹¤í–‰
        function execCommand(command, value = null) {
            document.execCommand(command, false, value);
            editor.focus();
        }

        // í°íŠ¸ ë³€ê²½
        function changeFont(fontFamily) {
            execCommand('fontName', fontFamily);
        }

        // í°íŠ¸ í¬ê¸° ë³€ê²½
        function changeFontSize(fontSize) {
            execCommand('fontSize', '3');
            const selection = window.getSelection();
            if (selection.rangeCount > 0) {
                const span = document.createElement('span');
                span.style.fontSize = fontSize;
                try {
                    selection.getRangeAt(0).surroundContents(span);
                } catch (e) {
                    console.log('í°íŠ¸ í¬ê¸° ë³€ê²½ ì‹¤íŒ¨');
                }
            }
        }

        // í…ìŠ¤íŠ¸ ìƒ‰ìƒ ë³€ê²½
        function changeTextColor(color) {
            execCommand('foreColor', color);
        }

        // ì—ë””í„°ì— ë‚´ìš© ì‚½ì…í•˜ëŠ” ê³µí†µ í•¨ìˆ˜
        function insertIntoEditor(element) {
            editor.focus();
            
            const selection = window.getSelection();
            let range;
            
            if (selection.rangeCount > 0) {
                range = selection.getRangeAt(0);
            } else {
                // ì„ íƒ ì˜ì—­ì´ ì—†ìœ¼ë©´ ì—ë””í„° ëì— ì‚½ì…
                range = document.createRange();
                range.selectNodeContents(editor);
                range.collapse(false);
            }
            
            // ê¸°ì¡´ ì„ íƒ ë‚´ìš© ì‚­ì œ
            range.deleteContents();
            
            // ìƒˆë¡œìš´ ìš”ì†Œ ì‚½ì…
            range.insertNode(element);
            
            // ì»¤ì„œë¥¼ ì‚½ì…ëœ ìš”ì†Œ ë’¤ë¡œ ì´ë™
            range.setStartAfter(element);
            range.collapse(true);
            
            // ì„ íƒ ì˜ì—­ ì—…ë°ì´íŠ¸
            selection.removeAllRanges();
            selection.addRange(range);
        }

        // ì´ëª¨ì§€ ì‚½ì…
        function insertEmoji(emoji) {
            const textNode = document.createTextNode(emoji + ' ');
            insertIntoEditor(textNode);
        }

        // êµ¬ë¶„ì„  ì‚½ì…
        function insertDivider() {
            const hr = document.createElement('hr');
            hr.style.border = 'none';
            hr.style.borderTop = '2px solid #e5e5e5';
            hr.style.margin = '20px 0';
            
            insertIntoEditor(hr);
        }

        // í…Œì´ë¸” ì‚½ì…
        function insertTable() {
            const table = document.createElement('table');
            table.className = 'editor-table';
            table.innerHTML = `
                <thead>
                    <tr>
                        <th>í—¤ë” 1</th>
                        <th>í—¤ë” 2</th>
                        <th>í—¤ë” 3</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ë‚´ìš© 1</td>
                        <td>ë‚´ìš© 2</td>
                        <td>ë‚´ìš© 3</td>
                    </tr>
                    <tr>
                        <td>ë‚´ìš© 4</td>
                        <td>ë‚´ìš© 5</td>
                        <td>ë‚´ìš© 6</td>
                    </tr>
                </tbody>
            `;
            
            insertIntoEditor(table);
        }

        // ëª¨ë‹¬ ì—´ê¸°
        function openImageModal() {
            document.getElementById('imageModal').style.display = 'block';
        }

        function openLinkModal() {
            document.getElementById('linkModal').style.display = 'block';
        }

        // ëª¨ë‹¬ ë‹«ê¸°
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // ì´ë¯¸ì§€ ì—…ë¡œë“œ ì²˜ë¦¬
        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (file && file.type.startsWith('image/')) {
                // íŒŒì¼ í¬ê¸° ì²´í¬ (5MB ì œí•œ)
                if (file.size > 5 * 1024 * 1024) {
                    alert('íŒŒì¼ í¬ê¸°ê°€ ë„ˆë¬´ í½ë‹ˆë‹¤. 5MB ì´í•˜ì˜ ì´ë¯¸ì§€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('imageUrl').value = e.target.result;
                    console.log('íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì½í˜”ìŠµë‹ˆë‹¤.');
                };
                reader.onerror = function() {
                    alert('íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                };
                reader.readAsDataURL(file);
            } else if (file) {
                alert('ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                event.target.value = ''; // íŒŒì¼ ì…ë ¥ ì´ˆê¸°í™”
            }
        }

        // ì´ë¯¸ì§€ ì‚½ì…
        function insertImage() {
            const imageUrl = document.getElementById('imageUrl').value;
            if (imageUrl) {
                const img = document.createElement('img');
                img.src = imageUrl;
                img.className = 'inserted-image';
                img.alt = 'ì‚½ì…ëœ ì´ë¯¸ì§€';
                
                // ì´ë¯¸ì§€ ë¡œë“œ ì²´í¬
                img.onload = function() {
                    console.log('ì´ë¯¸ì§€ê°€ ì„±ê³µì ìœ¼ë¡œ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.');
                };
                img.onerror = function() {
                    alert('ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. URLì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
                    return;
                };
                
                insertIntoEditor(img);
                
                closeModal('imageModal');
                document.getElementById('imageUrl').value = '';
                document.getElementById('imageInput').value = '';
            } else {
                alert('ì´ë¯¸ì§€ URLì„ ì…ë ¥í•˜ê±°ë‚˜ íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
            }
        }

        // ë§í¬ ì‚½ì…
        function insertLink() {
            const linkText = document.getElementById('linkText').value;
            const linkUrl = document.getElementById('linkUrl').value;
            
            if (linkText && linkUrl) {
                const a = document.createElement('a');
                a.href = linkUrl;
                a.textContent = linkText;
                a.target = '_blank';
                a.style.marginRight = '4px'; // ë§í¬ ë’¤ì— ì•½ê°„ì˜ ì—¬ë°± ì¶”ê°€
                
                insertIntoEditor(a);
                
                closeModal('linkModal');
                document.getElementById('linkText').value = '';
                document.getElementById('linkUrl').value = '';
            } else {
                alert('ë§í¬ í…ìŠ¤íŠ¸ì™€ URLì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
            }
        }

        // ë°œí–‰
        function publishPost() {
            const title = document.getElementById('postTitle').value;
            const content = document.getElementById('postContent').innerHTML;
            
            if (!title.trim()) {
                alert('ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                document.getElementById('postTitle').focus();
                return;
            }
            
            if (!content.trim() || content === '<br>') {
                alert('ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                editor.focus();
                return;
            }
            
            // ë°œí–‰ ì„¤ì • ëª¨ë‹¬ ì—´ê¸°
            document.getElementById('publishModal').style.display = 'block';
        }

        // ìµœì¢… ë°œí–‰
        function finalPublish() {
            const title = document.getElementById('postTitle').value;
            const content = document.getElementById('postContent').innerHTML;
            const category = document.getElementById('publishCategory').value;
            const subject = document.getElementById('publishSubject').value;
            const visibility = document.querySelector('input[name="visibility"]:checked').value;
            const publishTime = document.querySelector('input[name="publishTime"]:checked').value;
            const tags = document.getElementById('publishTags').value;
            
            // ì„¤ì •ê°’ë“¤ ìˆ˜ì§‘
            const settings = {
                allowComments: document.getElementById('allowComments').checked,
                allowGuestComments: document.getElementById('allowGuestComments').checked,
                allowScraps: document.getElementById('allowScraps').checked,
                blogCafePush: document.getElementById('blogCafePush').checked,
                allowExternalShare: document.getElementById('allowExternalShare').checked,
                ccl: document.getElementById('ccl').checked,
                saveAsDefault: document.getElementById('saveAsDefault').checked,
                notifySubscribers: document.getElementById('notifySubscribers').checked
            };
            
            // ì—¬ê¸°ì„œ ì‹¤ì œ ë°œí–‰ ë¡œì§ êµ¬í˜„
            const postData = {
                title,
                content,
                category,
                subject,
                visibility,
                publishTime,
                tags,
                settings,
                timestamp: new Date().toISOString()
            };
            
            console.log('ë°œí–‰í•  ê²Œì‹œë¬¼ ë°ì´í„°:', postData);
            
            // ì„ì‹œì €ì¥ ë°ì´í„° ì‚­ì œ
            localStorage.removeItem('blogDraft');
            
            closeModal('publishModal');
            alert('ê¸€ì´ ì„±ê³µì ìœ¼ë¡œ ë°œí–‰ë˜ì—ˆìŠµë‹ˆë‹¤!');
            
            // ì„ íƒì : í˜ì´ì§€ ì´ˆê¸°í™” ë˜ëŠ” ë¦¬ë‹¤ì´ë ‰íŠ¸
            if (confirm('ìƒˆ ê¸€ì„ ì‘ì„±í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                document.getElementById('postTitle').value = '';
                document.getElementById('postContent').innerHTML = '';
                document.getElementById('postTitle').focus();
            }
        }

        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ì‹œ ë‹«ê¸°
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }

        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 'b':
                        e.preventDefault();
                        execCommand('bold');
                        break;
                    case 'i':
                        e.preventDefault();
                        execCommand('italic');
                        break;
                    case 'u':
                        e.preventDefault();
                        execCommand('underline');
                        break;
                    case 's':
                        e.preventDefault();
                        // ì„ì‹œì €ì¥ ê¸°ëŠ¥
                        localStorage.setItem('blogDraft', JSON.stringify({
                            title: document.getElementById('postTitle').value,
                            content: document.getElementById('postContent').innerHTML,
                            timestamp: new Date().toISOString()
                        }));
                        alert('ì„ì‹œì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
                        break;
                }
            }
        });

        // í˜ì´ì§€ ë¡œë“œì‹œ ì„ì‹œì €ì¥ëœ ê¸€ ë³µêµ¬
        window.addEventListener('load', function() {
            const draft = localStorage.getItem('blogDraft');
            if (draft) {
                const data = JSON.parse(draft);
                if (confirm('ì„ì‹œì €ì¥ëœ ê¸€ì´ ìˆìŠµë‹ˆë‹¤. ë³µêµ¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    document.getElementById('postTitle').value = data.title;
                    document.getElementById('postContent').innerHTML = data.content;
                }
            }
            
            // ì—ë””í„° ì´ˆê¸° í¬ì»¤ìŠ¤ ì„¤ì •
            editor.focus();
        });
    </script>
</body>
</html>
